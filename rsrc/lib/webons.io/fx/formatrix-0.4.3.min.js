/*!
*  formatrix 0.4.3 (http://formatrix.org)
*
*
*  Copyright (c) 2016-2019 Germo Moeller / webons.industries
*
*  This source code is licensed under the MIT license found in the
*  LICENSE file in the root directory of this source tree.
*
*////***************************************************************************>
!function(root){"use strict";var self=null,$={prv:{$:{ver:"0.4.3",instance:null,config:{root:"fx",basepath:"/",locator:{web:"https://",cdn:"https://cdnjs.cloudflare.com/ajax/libs/",lib:"rsrc/lib/",app:"rsrc/app/"},locator_tries:{lib:[1,"web",2]},ajax:{method:"GET",url:"index.php",async:"false",query:{}}},es_ver:null,ns:{__ruler__:{boot:{},init:{},core:{}},__ruler__default:{status:0,src:null},__bundles__:{}},ns_scm:null,thread:null,mod_amd:[],pointer:{obj:{},raw:[]}}},pub:{$:{get ver(){return $.prv.$.ver},get es_ver(){return $.prv.$.es_ver},get config(){return $.pub.object_freeze($.prv.$.config)}},isTypeOf:function(e,r,t){return e=Object.prototype.toString.call(e).slice(8,-1),t&&"HTML"==e.substr(0,4)&&(e="DomObject"),r?e===r.name:e},object_merge:function(){for(var e={},r=0;r<arguments.length;r++)for(var t in arguments[r])if(!$.pub.isTypeOf(e[t],Object)||e[t]instanceof Array)e[t]=arguments[r][t];else{var n=Object.getOwnPropertyDescriptor(arguments[r],t);n&&(n.get||n.set)?Object.defineProperty(e,t,n):e[t]=$.pub.object_merge(e[t],arguments[r][t])}return e},object_create_path:function(e,r,t){return t||(t={}),$.pub.isTypeOf(e,String)&&(e=e.split(".")),e.length>0?function(e,r,t){for(var n=0;n<r.length-1;n++)e=e[r[n]]=e[r[n]]||{};e[r[r.length-1]]=$.pub.object_merge(e[r[r.length-1]],t)}(t,e,r):t=$.pub.object_merge(t,r),t},object_freeze:function(e){return Object.freeze(e),Object.getOwnPropertyNames(e).forEach(function(r){!e.hasOwnProperty(r)||null===e[r]||"object"!=typeof e[r]&&"function"!=typeof e[r]||Object.isFrozen(e[r])||$.pub.object_freeze(e[r])}),e},object_convert:function(e,r){var t,n,o,i=[];for(t in e)e.hasOwnProperty(t)&&(n=r?r+"["+t+"]":t,o=e[t],i.push(null!==o&&"object"==typeof o?$.pub.object_convert(o,n):encodeURIComponent(n)+"="+encodeURIComponent(o)));return i.join("&")},pointer:{current:function(e){return $.prv.$.ns.__ruler__[e].config},register:function(e,r,t){if(!e)return $.prv.$.pointer.obj;if(r){var n,o,i=!0;switch($.pub.isTypeOf(r)){case"Object":n=r;break;case"Array":n=$.pub.object_merge.apply(null,r);break;case"Function":i=!1}if(i||!0!==e){$.prv.$.pointer.raw[e]=n;var i=function(){};i.prototype=Object.create(n),i.prototype.constructor=i,o=new i(e)}else o=r;return $.prv.$.pointer.obj=$.pub.object_create_path(e,o,$.prv.$.pointer.obj),t&&$.pub.pointer.bind(),$.prv.$.pointer.obj}return $.pub.pointer.get(e)},bind:function(){Object.keys($.prv.$.pointer.obj).map(function(e){window[e]&&($.prv.$.pointer.obj[e]=function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e}(window[e],$.prv.$.pointer.obj[e])),window[e]=$.prv.$.pointer.obj[e]})},get:function(e){return"string"==typeof e?e.split(".").reduce(function(e,r){return e[r]||(e[r]={}),e[r]},$.prv.$.pointer.obj):$.prv.$.pointer.obj}},dom:{ready:function(e){"complete"===document.readyState?setTimeout(function(){return e&&e()},1):window.addEventListener("load",function(){return e&&e()},!1)},load_script:function(e,r,t){t||(e=$.pub.namespace.get_src(e));var n=document.createElement("script");r&&(n.onload=n.onerror=r()),n.src=e,n.charset="utf-8",document.head.appendChild(n)},execute_scripts:function(e,r){for(var t,n=document.querySelectorAll('script[type="'+e+'"]'),o="",i=[],p=0;p<n.length;p++)n[p].dataset.load?i.push(n[p].dataset.load):o+=n[p].innerHTML.toString().replace("\t","").split("\r\n"),n[p].type=e+":ready";if(t=i.length)for(var p=0;p<i.length;p++)$.pub.dom.load_script(i[p],function(){0==--t&&o&&$.pub.dom.load_script("data:text/plain;base64,"+btoa(o),null,!0)});else o&&$.pub.dom.load_script("data:text/plain;base64,"+btoa(o),null,!0)}},screen:{},request:{get:function(e){e=e||{},e.url=e.url?e.url:$.prv.$.config.ajax.url,e.url=e.url+"?"+$.pub.object_convert(e.query);var r=new XMLHttpRequest;r.open(e.method?e.method:$.prv.$.config.ajax.method,e.url,e.async?e.async:$.prv.$.config.ajax.async,e.user?e.user:null,e.pswd?e.pswd:null),r.onreadystatechange=function(r){4==this.readyState&&200==this.status?e.success&&e.success.call(this):4==this.readyState&&e.error&&e.error.call(this)},r.send(null)}},cmd:{resolve:function(e){return $.pub.namespace.get_src($.pub.namespace.parse_namespace(e).id)}}}};$.prv.thread=function(){$.prv.$.thread=this,this.$={status:null,tm:0,required:[],loaded:[],callback:[]}},$.prv.thread.prototype.start=function(){new $.prv.tm},$.prv.thread.prototype.close=function(){!1===$.prv.$.ns.__ruler__.boot.status&&(this.$.callback.unshift($.prv.$.ns.__ruler__.boot.mirror),$.prv.$.ns.__ruler__.boot.status=!0);var e=this.$.callback.length;this.$.callback.map(function(r){setTimeout(function(){$.prv.namespace.callback(r),0==--e&&($.pub.dom.ready(function(){$.pub.dom.execute_scripts("fx/namespace")}),$.pub.pointer.bind())},10)}),this.$.status=!1},$.prv.tm=function(e){$.prv.$.thread.$.status=!0,this.thread=$.prv.$.thread,e?this.start(e):this.close()},$.prv.tm.prototype.start=function(e,r){var t=this,n=document.createElement("script");n.src=e,$.prv.$.es_ver>5&&(n.type="module"),n.charset="utf-8",n.async="true",n.onload=function(){if($.prv.$.mod_amd.length>=1){var e=new $.pub.namespace(r),n=$.prv.$.mod_amd.shift();e.pub({module:new n[n.length-1]})}t.thread.$.tm--,t.close()},setTimeout(function(){document.head.appendChild(n)},10),this.thread.$.tm++},$.prv.tm.prototype.close=function(){if(this.thread.$.required.length>=1)for(var e,r=this;void 0!==(e=this.thread.$.required.shift());)r.start($.pub.namespace.get_src(e),e),this.thread.$.loaded.push(e);0==this.thread.$.tm&&this.thread.close()},$.prv.namespace={setModifiers:function(){delete $.prv.$.config.locator.sys,Object.keys($.prv.$.config.locator).map(function(e){$.prv.$.ns_scm.push([e+"://",$.prv.$.config.locator[e]])})},callback:function(e){var r;Object.keys(e.$.use).map(function(t){if(r=$.prv.$.ns[e.$.use[t].id]){if(e.$.use[t].node)for(var n=e.$.use[t].node.split("."),o=0;o<n.length;o++){var i=/(.*?)\((.*?)\)/.exec(n[o]);i&&(n[o]=i[1]),void 0===r[n[o]]?(r[n[o]]=null,o=n.length):r=i?r[i[1]](i[2]):r[n[o]]}}else r={};e[e.$.use[t].key]=r}),Object.keys(e.$.pub).map(function(r){"object"==typeof e.$.pub[r]?Object.keys(e.$.pub[r]).map(function(t){var n=Object.getOwnPropertyDescriptor(e.$.pub[r],t);$.prv.$.ns[e.$.id][t]||Object.defineProperty($.prv.$.ns[e.$.id],t,n),e[t]||Object.defineProperty(e,t,n)}):$.prv.$.ns[e.$.id]=e.$.pub[r]}),Object.keys(e.$.run).map(function(r){if(e.$.run[r]){var t=e.$.run[r];t.prototype=Object.create({}),Object.keys(e).map(function(r){if(!t.prototype[r]){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t.prototype,r,n)}}),new t}delete e.$.run[r]}),e.$.win&&($.pub.isTypeOf(e.$.win,Function)&&(e.$.win=e.$.win()),r=$.prv.$.ns.__ruler__[e.$.id].pointer,r||(r=!0),$.pub.pointer.register(r,e.$.win,!0))}},$.pub.namespace=function(id,cfg){if(self=$.prv.namespace.self,$.prv.$.thread&&0!=$.prv.$.thread.$.status||new $.prv.thread,this.$={id:self.parse_namespace(id||"default").id,use:[],pub:[],run:[],win:null},$.prv.$.ns.__ruler__[this.$.id]){if(!$.prv.$.ns.__ruler__[this.$.id].config||!$.prv.$.ns.__ruler__[this.$.id].config.writable)return!1}else $.prv.$.ns.__ruler__[this.$.id]=Object.create($.prv.$.ns.__ruler__default),$.prv.$.ns.__ruler__[this.$.id].config=cfg,$.prv.$.ns[this.$.id]={},this.$.id==$.prv.$.ns.__ruler__.core.id&&(this.core=$);if(null!==$.prv.$.instance){var x=$.prv.$.thread.$.required.indexOf(this.$.id);x>=0&&$.prv.$.thread.$.required.splice(x,x+1),$.prv.$.thread.$.callback.unshift(this)}$.prv.$.instance?(cfg&&(cfg.called?cfg.parent&&$.prv.$.ns.__ruler__[cfg.parent]&&(cfg.called=$.prv.$.ns.__ruler__[cfg.parent].pointer+"."+cfg.called):cfg.called="",$.prv.$.ns.__ruler__[this.$.id].pointer=cfg.called),this[$.prv.$.config.root]=$.pub):!1===$.prv.$.instance?(cfg.init.config&&($.prv.$.config=$.pub.object_merge($.prv.$.config,cfg.init.config)),$.prv.namespace.setModifiers(),cfg.init.use&&(cfg.init.use.core&&($.prv.$.ns.__ruler__.core.id=cfg.init.use.core),boot.use(cfg.init.use)),this.use({require:"cdn://require.js/2.3.6/require.min.js"}),delete cfg.init,cfg.called||(cfg.called=""),$.prv.$.ns.__ruler__[this.$.id].pointer=cfg.called,$.prv.$.ns.__ruler__.init.id=this.$.id,$.prv.$.ns.__ruler__.init.config=cfg,$.prv.$.ns.__ruler__[$.prv.$.ns.__ruler__.boot.id].pointer=$.prv.$.config.root,void 0!==root[$.prv.$.config.root]&&($.pub=$.pub.object_merge(root[$.prv.$.config.root],$.pub)),this[$.prv.$.config.root]=$.pub,root[$.prv.$.config.root]=$.pub,$.prv.$.instance=!0):($.prv.$.ns.__ruler__.boot.id=this.$.id,$.prv.$.ns.__ruler__.boot.config=cfg,$.prv.$.ns.__ruler__.boot.mirror=this,$.prv.$.ns.__ruler__.boot.status=!1,"undefined"!=typeof fx&&($.pub=$.pub.object_merge(fx,$.pub)),!function(){try{eval("var foo = (x)=>x+1")}catch(e){return!1}return!0}()?$.prv.$.es_ver=5:$.prv.$.es_ver=6,$.prv.$.ns_scm=[["~?","_es"+$.prv.$.es_ver]],window.DomObject={name:"DomObject"},String.name||(String.name="String",Array.name="Array",Object.name="Object",Function.name="Function"),$.prv.$.instance=!1)},$.pub.namespace.prototype.use=function(e){if(!e)return null;$.pub.isTypeOf(e,String)&&(e=[e]);var r=this;Object.keys(e).map(function(t){var n=self.parse_namespace(e[t]);r.$.use.push({key:t,id:n.id,node:n.node}),$.prv.$.ns.__ruler__[n.id]||-1!=$.prv.$.thread.$.required.indexOf(n.id)?r[t]||(r[t]=$.prv.$.ns.__ruler__[r.$.id]):$.prv.$.thread.$.required.unshift(n.id)}),$.prv.$.thread.$.status||$.prv.$.thread.start()},$.pub.namespace.prototype.prv={},$.pub.namespace.prototype.pub=function(e){this.$.pub.push(e)},$.pub.namespace.prototype.run=function(e){this.$.run.push(e),$.prv.$.thread.$.status||$.prv.$.thread.close()},$.pub.namespace.prototype.win=function(e){this.$.win=e},$.pub.namespace.parse_namespace=function(e){return e=e.split("::"),e[2]=/\?\?/.exec(e[0]),e[2]&&(e[0]=e[0].substring(0,e[2].index)),/\.js$/.test(e[0])&&(e[0]=e[0].slice(0,-3)),e[3]=/\[\s*(.*?)\s*\]/.exec(e[0]),e[3]=e[3]?e[3][1]:null,{id:e[0],node:e[1],query:e[2],locator:e[3]}},$.pub.namespace.get_src=function(e){for(var r,t=0;t<=$.prv.$.ns_scm.length-1;t++)r=$.prv.$.ns_scm[t][1],e=e.replace($.prv.$.ns_scm[t][0],r);return"/"==e.slice(-1)&&(e+="index"),/\.(js|css)$/.test(e)||(e+=".js"),e},$.pub.namespace.vbind=function(e,r,t,n){return $.prv.$.ns.__bundles__[e]||(t||(t=""),n||(n=""),$.prv.$.ns.__bundles__[e]=e+n+r+t),$.prv.$.ns.__bundles__[e]},$.prv.amd=function(){$.prv.$.mod_amd.push(arguments)},$.prv.namespace.self=$.pub.namespace;var data=document.querySelector("script[data-init]"),boot=new $.pub.namespace("sys://formatrix-"+$.prv.$.ver+"/",data);boot.use(data.getAttribute("data-init")),boot.pub($.pub),root.Namespace=$.pub.namespace,root.define=$.prv.amd,define.amd=!0}(window);
